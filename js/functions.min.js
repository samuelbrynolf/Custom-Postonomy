(function(b,d,e){var c=function(f){return f.each(function(){var o=d(this),n,k,m,g=15,h;function j(p){p.preventDefault();d(p.target).trigger("tap",[p])}function i(){m=b.document.body.scrollTop;if(o.is("a")){h=o[0].href;o[0].href="#"}}function l(p){p.preventDefault();if(n&&n!==p.type){return false}n=p.type;clearTimeout(k);k=setTimeout(function(){n=null},1000);if(p.type==="touchend"&&Math.abs(b.document.body.scrollTop-m)>g){return false}if(h){o[0].href=h}h=null;j(p)}o.bind("touchstart",i).bind("touchend",l).bind("click",l)})};var a=d.fn.bind;d.fn.bind=function(f,g){if(/(^| )tap( |$)/.test(f)){c(this)}return a.apply(this,[f,g])}}(this,jQuery));var $fCPT=jQuery.noConflict();$fCPT(function(){var a=$fCPT("#js-cptItems");var b=$fCPT("#js-filters .filter");var e=$fCPT("a.s-is-appHome");var c=e.attr("href")+" "+e.attr("data-role")+" > * ";function d(i){var g=i.url;var f=$fCPT("[data-id="+i.caller+"]");if($fCPT("#loadMessage").length===0){$fCPT('<p id="loadMessage">Loading...</p>').insertBefore(a)}var h=$fCPT("#loadMessage");h.fadeIn("fast");b.removeClass("s-is-current");f.addClass("s-is-current");function j(){h.fadeOut("fast")}function k(){a.load(g,function(){a.fadeIn("medium",j)})}a.hide(0,k)}b.each(function(f){var g=$fCPT(this);g.attr("data-id","link"+f)}).bind("tap",function(i){i.preventDefault();var h=$fCPT(this);var f=h.attr("href")+" "+h.attr("data-role")+" > *";var g={url:f,caller:h.attr("data-id")};History.pushState(g,h.text(),h.attr("href"))});History.Adapter.bind(window,"statechange",function(){var f=History.getState().data;if(typeof f.url==="undefined"){f.url=c;f.caller=e.attr("data-id")}d(f)})});